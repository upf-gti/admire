{"version":3,"sources":["components/streamSettings.js","components/toasts.js","extra/bra/rtcClient.js","extra/bra/index.js","extra/bra/lobbyClient.js","extra/bra/mediaAdapter.js","extra/bra/dummyStream.js","extra/cookies.js","assets/img/wizard2.png","views/app.js","index.js"],"names":["StreamSettings","createContext","children","videoRef","useRef","useState","devices","setDevices","settings","setSettings","resolutions","setResolutions","useReducer","value","newvalue","current","srcObject","dummyStream","getStream","localStream","setLocalStream","store","onGotResolutions","onGotDevices","audio","audioDevices","video","videoDevices","onGotStream","stream","callId","rtcClient","getCalls","call","getCall","track","getVideoTracks","replaceLocalVideoTrack","getAudioTracks","replaceLocalAudioTrack","onError","description","console","error","onUnload","mediaAdapter","off","useEffect","on","getDevices","window","removeEventListener","addEventListener","Provider","ToastContext","loading","text","options","toast","promise","success","s","log","e","Object","assign","style","minWidth","icon","trace","background","info","warn","RTCCall","callerId","calleeId","_callId","_callerId","_calleeId","_connection","_candidates","getState","iceConnectionState","getStats","a","then","stats","callStats","candidatePair","forEach","report","type","selected","state","id","localCandidateId","localType","candidateType","localAddress","address","ip","localPort","port","localProtocol","protocol","remoteCandidateId","remoteType","remoteAddress","remotePort","remoteProtocol","Promise","resolve","addCandidate","candidate","addIceCandidate","push","gatherPendingCandidates","length","getRemoteAudioTrack","index","receivers","getReceivers","tracks","i","receiver","kind","getRemoteVideoTrack","getRemoteStream","MediaStream","addTrack","audioSenders","senders","getSenders","sender","replaceTrack","videoSenders","appClient","debug","debugStyle","pingPeriod","_events","_token","_socket","_keepAliveTimeout","_userId","_channels","emit","event","args","slice","arguments","listeners","apply","this","onOpen","keepAlive","url","onMessage","msg","message","JSON","parse","data","HANDLERS","Function","sendMessage","stringify","send","onClose","clearTimeout","readyState","ping","setTimeout","validateId","RegExp","test","status","userId","roomId","channelId","listener","indexOf","splice","connect","WebSocket","onopen","onmessage","onclose","disconnect","close","login","token","logout","getRoom","getRooms","createRoom","joinRoom","leaveRoom","enableChannel","disableChannel","joinChannel","leaveChannel","forwardMessage","isDisconnected","isLogged","isInChannel","_blackCanvas","_audioStream","_videoStream","_mediaStream","_audioDevices","_videoDevices","_resolutions","width","undefined","height","_audioConstraints","deviceId","exact","_videoConstraints","frameRate","ideal","_streamSettings","resolution","_previousAudioConstraints","_previousVideoConstraints","findDevices","gotDevices","catch","errorDevices","setDefaultDevices","localStorage","getItem","removeItem","setAudio","setVideo","navigator","mediaDevices","enumerateDevices","deviceInfos","v","deviceInfo","label","device","reject","Error","setItem","getSilenceStream","mixStreams","clone","getAudioStream","getBlackStream","getVideoStream","getSilenceTrack","audioContext","AudioContext","gainNode","createGain","oscillatorNode","createOscillator","destination","createMediaStreamDestination","gain","setValueAtTime","currentTime","start","getBlackTrack","document","createElement","context","getContext","fillRect","captureStream","videoTrack","stopStream","getUserMedia","gotAudioStream","errorAudioStream","gotVideoStream","errorVideoStream","audioTrack","audioTrackSettings","getSettings","videoTrackSettings","entries","sort","b","Number","NEGATIVE_INFINITY","reduce","r","k","errorStream","name","audioStream","videoStream","audioTracks","videoTracks","getTracks","stop","object","catchCallback","initialize","_silenceStream","_blackStream","_silenceTrack","_blackTrack","createSilenceTrack","createBlackTrack","_stream","getAudioTrack","getVideoTrack","_settings","defaultStream","_calls","_rtcConfiguration","iceServers","closeCall","connection","hangup","onIceConnectionStateChange","peerConnection","RTCPeerConnection","oniceconnectionstatechange","other","onicecandidate","onnegotiationneeded","createOffer","sdp","setLocalDescription","offer","setRemoteDescription","createAnswer","answer","register","unregister","acceptCall","cancelCall","DEBUG","setCookie","cName","cValue","expDays","date","Date","setTime","getTime","cookie","toUTCString","getCookie","res","decodeURIComponent","split","val","substring","Room","lazy","Login","Lobby","Wizzard","ResetPassword","Navbar","App","rtcUrl","appUrl","Log","useHistory","useContext","setLogin","NavItems","setNavItems","newState","sessionStorage","initialValue","ready","setReady","onAppClientConnect","onRtcClientConnect","onDisconnect","onLogOut","setNavItem","item","clear","to","Image","src","img3","filter","fullscreenEnabled","Button","onClick","fullscreen","exitFullscreen","body","requestFullscreen","variant","zIndex","position","top","right","border","boxShadow","className","fallback","ProgressBar","animated","now","path","user","doLogOut","items","values","Math","floor","random","ContextContainer","Helmet","rel","as","href","reverseOrder","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.c4c8be33.chunk.js","sourcesContent":["//https://medium.com/@nazmifeeroz/how-to-use-react-usecontext-and-usestate-hooks-as-a-global-store-1b4f1898034f\r\n\r\nimport { createContext, useState, useReducer, useRef, useEffect } from 'react';\r\nimport { rtcClient, appClient, mediaAdapter, dummyStream } from 'extra/bra';\r\n\r\n\r\nexport const StreamSettings = createContext(null);\r\n\r\n//To initialize data\r\n // eslint-disable-next-line import/no-anonymous-default-export\r\nexport default function({children})\r\n{\r\n    const videoRef                        = useRef(null);\r\n    const [ devices , setDevices ]        = useState(null);\r\n    const [ settings, setSettings ]       = useState(null);\r\n    const [ resolutions, setResolutions ] = useState(null);\r\n    const [ localStream, setLocalStream ] = useReducer( (value, newvalue)=>{\r\n        if( videoRef && videoRef.current )\r\n            videoRef.current.srcObject = newvalue;\r\n        return newvalue;\r\n    }, dummyStream.getStream() );\r\n\r\n    const store = {\r\n        videoRef,\r\n        devices:     [ devices , setDevices ],\r\n        settings:    [ settings, setSettings ], \r\n        resolutions: [ resolutions, setResolutions ],   \r\n        localStream: [ localStream, setLocalStream ],\r\n    }\r\n\r\n    function onGotResolutions({resolutions})\r\n    { \r\n        setResolutions(resolutions); \r\n    }\r\n    \r\n    function onGotDevices ({ audioDevices: audio, videoDevices: video, settings }) \r\n    { \r\n        setSettings(settings);\r\n        setDevices({audio, video});\r\n    }\r\n\r\n    function onGotStream( {stream, settings})\r\n    { \r\n        setSettings(settings);\r\n        setLocalStream(stream);\r\n\r\n        for( const callId in rtcClient.getCalls() )\r\n        {\r\n            let call = rtcClient.getCall(callId);\r\n            \r\n            //track.enabled = true;\r\n            {\r\n                let track = stream.getVideoTracks()[0];\r\n                call.replaceLocalVideoTrack(track);\r\n            }\r\n            {\r\n                let track = stream.getAudioTracks()[0];\r\n                call.replaceLocalAudioTrack(track);\r\n            }\r\n            \r\n        }\r\n    }\r\n\r\n    function onError({description}){\r\n        console.error(\"Error:\", description);\r\n    }\r\n\r\n    function onUnload(){\r\n        mediaAdapter.off(\"got_stream\",        onGotStream );\r\n        mediaAdapter.off('got_devices',       onGotDevices );\r\n        mediaAdapter.off(\"got_resolutions\",   onGotResolutions );\r\n        mediaAdapter.off(\"error_stream\",      onError);\r\n        mediaAdapter.off(\"error_devices\",     onError);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        mediaAdapter.on(\"got_stream\",         onGotStream );\r\n        mediaAdapter.on('got_devices',        onGotDevices );\r\n        mediaAdapter.on(\"got_resolutions\",    onGotResolutions );\r\n        mediaAdapter.on(\"error_stream\",       onError);\r\n        mediaAdapter.on(\"error_devices\",      onError);\r\n        mediaAdapter.getDevices();\r\n\r\n        window.removeEventListener('unload ', onUnload);\r\n        window.addEventListener('unload ',    onUnload);\r\n        \r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    },[]);\r\n\r\n    return (<StreamSettings.Provider value={store}>{children}</StreamSettings.Provider>);\r\n}\r\n","/*\r\nAuthor: Hermann Plass (hermann.plass@gmail.com)\r\ntoast.js (c) 2021\r\nDesc: description\r\nCreated:  2021-05-04T14:10:47.108Z\r\nModified: 2021-05-04T15:49:39.655Z\r\nhttps://blog.logrocket.com/how-to-create-a-custom-toast-component-with-react/\r\n*/\r\nimport { useState, useEffect, createContext, useContext } from 'react';\r\nimport { Toast, ToastBody, Button } from 'react-bootstrap';\r\nimport toast from 'react-hot-toast';\r\n\r\nexport const ToastContext = createContext(null);\r\n\r\nlet id = 0;\r\n\r\n // eslint-disable-next-line import/no-anonymous-default-export\r\nexport default function ({children}){\r\n    const [list, setList] = useState([]);\r\n\r\n    function info(description, options)\r\n    {\r\n        console.log(`%c Info %c: ${description}`, \"background-color:cyan; color:black; font-weight: bolder;\", 'color:white');\r\n        return toast(`${description}`, Object.assign({icon:'📣'},options))\r\n        //setList([...list,{id:++id, show:true, type:\"Info\",description}]);\r\n    }\r\n\r\n    function error(description, options)\r\n    {\r\n        console.trace(`%c Error %c: ${description}`, \"background-color:red; color:white\", 'color:white');\r\n        //setList([...list, {id:++id, show:true, type:\"Error\",description}]);\r\n        return toast(`${description}`, Object.assign({icon:'👎', style:{ background:'#DC143C'}},options));\r\n    }\r\n\r\n    function warn(description, options)\r\n    {\r\n        console.warn(`%c Warn %c: ${description}`, \"background-color:orange; color:black\", 'color:white');\r\n        //setList([...list, {id:++id, show:true, type:\"Warn\",description}]);\r\n\r\n        return toast(`${description}`, Object.assign({icon:'⚠️', style:{background:'#FFA500'}},options))\r\n    }\r\n\r\n    function success(description, options)\r\n    {\r\n        console.log(`%c Success %c: ${description}`, \"background-color:green\", 'color:white');\r\n        //setList([...list, {id:++id, show:true, type:\"Success\",description} ]);\r\n        return toast.success(`${description}`, Object.assign({icon:'👍'},options))\r\n    }\r\n\r\n    function promise(promise, success, error, options)\r\n    {\r\n        return toast.promise(promise, {\r\n            loading: 'Processing...', \r\n            success: success??((s) => { console.log(s); return (s??'Success!'); }), \r\n            error:   error??((e) => { console.error(e); return (`Error:${e}`); })\r\n        },\r\n        Object.assign({\r\n            style: {\r\n              minWidth: '250px',\r\n            },\r\n            loading: {icon: '📤'},\r\n            success: {icon: '👍'},\r\n            error:   {icon: '👎'},\r\n        },options));\r\n    }\r\n\r\n    function loading(text, options)\r\n    {\r\n        return toast.loading(text??'Loading...', options);\r\n    }\r\n\r\n    const store = {\r\n        //toasts: [list, setList],\r\n        loading,\r\n        promise,\r\n        success,\r\n        error,\r\n        info,\r\n        warn,\r\n    }\r\n\r\n    return (<ToastContext.Provider value={store}>{children}</ToastContext.Provider>);\r\n}","export function RTCClient( settings )\r\n{\r\n//#region PRIVATE\r\n\r\n    let _settings =\r\n    {\r\n        // Debug messages to console?\r\n        debug: false,\r\n\r\n        // Style used to debug messages.\r\n        debugStyle: \"background: hsla(0, 0%, 13%, 1); color: hsla(74, 64%, 60%, 1)\",\r\n\r\n        // Period to send ping messages in ms.\r\n        pingPeriod: 5 * 1000,\r\n\r\n        // The default stream to send.\r\n        defaultStream: new MediaStream()\r\n    };\r\n\r\n    settings = (typeof settings !== \"object\") ? { } : settings;\r\n    settings = Object.assign(_settings, settings);\r\n\r\n    let console = (settings.debug) ? window.console : null;\r\n\r\n    let _events = { };\r\n    let _socket = null;\r\n    let _keepAliveTimeout = null;\r\n    let _calls = { };\r\n\r\n    let _userId = null;\r\n    let _rtcConfiguration = { iceServers: null };\r\n\r\n    /**\r\n     * Add a function that will be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The function to add.\r\n     */\r\n    let on = function( event, listener )\r\n    {\r\n        if( typeof _events[event] !== \"object\" )\r\n        {\r\n            _events[event] = [];\r\n        }\r\n\r\n        _events[event].push(listener);\r\n    };\r\n\r\n    /**\r\n     * Remove the function previously added to be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The previously added function.\r\n     */\r\n    let off = function( event, listener )\r\n    {   \r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let index = _events[event].indexOf(listener);\r\n            if( index > -1 )\r\n            {\r\n                _events[event].splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Emit the specified event.\r\n     * @param {String} event - The event name.\r\n     */\r\n    let emit = function( event )\r\n    {\r\n        let args = [].slice.call(arguments, 1);\r\n\r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let listeners = _events[event].slice();\r\n            for( let i = 0; i < listeners.length; i++ )\r\n            {\r\n                listeners[i].apply(this, args);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the call identified by the specified ID.\r\n     * @param {String} callId - The call ID.\r\n     * @return The call.\r\n     */\r\n    let getCall = function( callId )\r\n    {\r\n        return (callId in _calls) ? _calls[callId] : null;\r\n    };\r\n \r\n    /**\r\n     * Get all the calls.\r\n     * @return The calls collection.\r\n     */\r\n    let getCalls = function()\r\n    {\r\n        return _calls;\r\n    };\r\n\r\n    /**\r\n     * Connect to the server.\r\n     * @param {String} url - The URL of the server.\r\n     */\r\n    let connect = function( url )\r\n    {\r\n        if( _socket && _socket.readyState != 3 ) // Closed.\r\n        {\r\n            return;\r\n        }\r\n\r\n        _socket = new WebSocket(url);\r\n\r\n        _socket.onopen = onOpen;\r\n        _socket.onmessage = onMessage;\r\n        _socket.onclose = onClose;\r\n    };\r\n\r\n    /**\r\n     * Disconnect from the server.\r\n     */\r\n    let disconnect = function()\r\n    {\r\n        if( !_socket || _socket.readyState == 1 ) // Open.\r\n        {\r\n            return;\r\n        }\r\n\r\n        _socket?.close();\r\n    };\r\n\r\n    /**\r\n     * Event handler called when the connection is opened.\r\n     * @param {EventListener} event - The dispatched event.\r\n     */\r\n    let onOpen = function( event )\r\n    {\r\n        // Start the keep alive routine.\r\n        keepAlive();\r\n\r\n        console?.log(\"%c\" + \"client_connected\" + \"%o\", settings.debugStyle, _socket.url);\r\n\r\n        emit(\"client_connected\", { url: _socket.url });\r\n    };\r\n\r\n    /**\r\n     * Event handler called when a message is received from the server.\r\n     * @param {EventListener} msg - The message received.\r\n     */\r\n    let onMessage = function( msg )\r\n    {\r\n        let message = JSON.parse(msg.data);\r\n\r\n        // Check the message.\r\n        if( message.id in HANDLERS )\r\n        {\r\n            if( HANDLERS[message.id] === false )\r\n            {\r\n                return;\r\n            }\r\n\r\n            console?.log(\"%c%s\" + \"%o\", settings.debugStyle, message.id, msg.data);\r\n\r\n            if( HANDLERS[message.id] instanceof Function )\r\n            {\r\n                HANDLERS[message.id](message);\r\n            }\r\n\r\n            emit(message.id, message);\r\n        }\r\n        else\r\n        {\r\n            console?.log(\"%cunknown_message\" + \"%o\", settings.debugStyle, msg.data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Event handler called when the connection is closed.\r\n     * @param {EventListener} event - The dispatched event.\r\n     */\r\n    let onClose = function( event )\r\n    {\r\n        _userId = null;\r\n        _rtcConfiguration.iceServers = null;\r\n\r\n        // Stop the keep alive routine.\r\n        window.clearTimeout(_keepAliveTimeout);\r\n\r\n        console?.log(\"%c\" + \"client_disconnected\" + \"%o\", settings.debugStyle, _socket.url);\r\n        emit(\"client_disconnected\", { url: _socket.url });\r\n    };\r\n\r\n    /**\r\n     * Send a message to the server.\r\n     * @param {Object} message - The message to send.\r\n     */\r\n    let sendMessage = function( message )\r\n    {\r\n        let msg = JSON.stringify(message);\r\n\r\n        // Log all messages except pings.\r\n        if( message.id !== \"ping\" )\r\n        {\r\n            console?.log(\"%c%s\" + \"%o\", settings.debugStyle, message.id, msg);\r\n        }\r\n\r\n        _socket.send(msg);\r\n    };\r\n\r\n    /**\r\n     * Start a keep alive routine.\r\n     */\r\n    let keepAlive = function()\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return;\r\n        }\r\n\r\n        ping();\r\n\r\n        _keepAliveTimeout = window.setTimeout(keepAlive, settings.pingPeriod);\r\n    };\r\n \r\n    /**\r\n     * Send a ping to the server.\r\n     */\r\n    let ping = function()\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        let message =\r\n        {\r\n            id: \"ping\"\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Register to the server.\r\n     * @param {String} userId - The user ID.\r\n     * @return {Boolean} Whether the register message has been sent.\r\n     */\r\n    let register = function( userId )\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( _userId )\r\n        {\r\n            console?.error(\"Client already registered\");\r\n            return false;\r\n        }\r\n\r\n        if( !validateId(userId) )\r\n        {\r\n            console?.error(\"Invalid user id \" + userId);\r\n            return false;\r\n        }\r\n\r\n        let message =\r\n        {\r\n            id: \"register\",\r\n            userId: userId\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Unregister from the server.\r\n     */\r\n    let unregister = function()\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( !_userId )\r\n        {\r\n            console?.error(\"Client not registered\");\r\n            return false;\r\n        }\r\n\r\n        hangup();\r\n\r\n        let message =\r\n        {\r\n            id: \"unregister\",\r\n            userId: _userId\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Call a user with the specified stream.\r\n     * @param {String} calleeId - The callee ID.\r\n     */\r\n    let call = function( calleeId )\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( _userId === calleeId || !validateId(calleeId) )\r\n        {\r\n            console?.error(\"Invalid user id \" + calleeId);\r\n            return false;\r\n        }\r\n\r\n        let message =\r\n        {\r\n            id: \"call\",\r\n            callerId: _userId,\r\n            calleeId: calleeId\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Close a call.\r\n     * @param {String} callId - The call ID.\r\n     */\r\n    let closeCall = function( callId )\r\n    {\r\n        if( !(callId in _calls) )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let call = _calls[callId];\r\n        call.connection?.close();\r\n        delete(_calls[callId]);\r\n\r\n        emit(\"call_closed\", { call: call });\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Accept a call.\r\n     * @param {String} callId - The call ID.\r\n     */\r\n    let acceptCall = function( callId )\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( !(callId in _calls) )\r\n        {\r\n            console?.error(\"Call \" + callId + \" not found\");\r\n            return false;\r\n        }\r\n\r\n        let call = _calls[callId];\r\n\r\n        let message =\r\n        {\r\n            id: \"accept_call\",\r\n            callId: call.callId,\r\n            callerId: call.callerId,\r\n            calleeId: call.calleeId\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Cancel a call.\r\n     * @param {String} callId - The call ID.\r\n     */\r\n    let cancelCall = function( callId )\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( !(callId in _calls) )\r\n        {\r\n            console?.error(\"Call \" + callId + \" not found\");\r\n            return false;\r\n        }\r\n\r\n        // Delete the call.\r\n        let call = _calls[callId];\r\n        delete _calls[callId];\r\n\r\n        let message =\r\n        {\r\n            id: \"cancel_call\",\r\n            callId: call.callId,\r\n            callerId: call.callerId,\r\n            calleeId: call.calleeId\r\n        };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Hang up a call. If call ID is undefined then all calls are hang up.\r\n     * @param {String} callId - The call ID.\r\n     */\r\n    let hangup = function( callId )\r\n    {\r\n        if( !_socket || _socket.readyState !== 1 ) // Open.\r\n        {\r\n            console?.error(\"Socket state: \" + _socket.readyState);\r\n            return false;\r\n        }\r\n\r\n        if( callId && !(callId in _calls) )\r\n        {\r\n            console?.error(\"Call \" + callId + \" not found\");\r\n            return false;\r\n        }\r\n\r\n        if( callId )\r\n        {\r\n            closeCall(callId);\r\n\r\n            let message =\r\n            {\r\n                id: \"hangup\",\r\n                callId: callId\r\n            };\r\n            sendMessage(message);\r\n\r\n            return true;\r\n        }\r\n        else // Hang up all calls.\r\n        {\r\n            for( let callId in _calls )\r\n            {\r\n                closeCall(callId);\r\n\r\n                let message =\r\n                {\r\n                    id: \"hangup\",\r\n                    callId: callId\r\n                };\r\n                sendMessage(message);\r\n            }\r\n\r\n            return true;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Register response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onRegisterResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _userId = event.userId;\r\n            _rtcConfiguration.iceServers = JSON.parse(event.iceServers);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Unregister response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onUnregisterResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _userId = null;\r\n            _rtcConfiguration.iceServers = null;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Call response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onCallResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            // Create the call.\r\n            let call = new RTCCall(event.callId, event.callerId, event.calleeId);\r\n            _calls[call.callId] = call;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Incoming call event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onIncomingCall = function( event )\r\n    {\r\n        // Create the call.\r\n        let call = new RTCCall(event.callId, event.callerId, event.calleeId);\r\n        _calls[event.callId] = call;\r\n    };\r\n\r\n    /**\r\n     * Call accepted event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onCallAccepted = function( event )\r\n    {\r\n        // Create the peer connection.\r\n        let peerConnection = new RTCPeerConnection(_rtcConfiguration);\r\n        let call = _calls[event.callId];\r\n        call.connection = peerConnection;\r\n\r\n        // Handle the peer connection lifecycle.\r\n        call.connection.oniceconnectionstatechange = function( other )\r\n        {\r\n            onIceConnectionStateChange(call);\r\n        }\r\n\r\n        // Generate candidates.\r\n        call.connection.onicecandidate = function( other )\r\n        {\r\n            if( !other.candidate || other.candidate === \"\" ) // Empty if the RTCIceCandidate is an \"end of candidates\" indicator.\r\n            {\r\n                return;\r\n            }\r\n\r\n            let message =\r\n            {\r\n                id: \"candidate\",\r\n                callId: event.callId,\r\n                callerId: event.callerId,\r\n                calleeId: event.calleeId,\r\n                candidate: JSON.stringify(other.candidate)\r\n            };\r\n            sendMessage(message);\r\n        };\r\n\r\n        call.connection.onnegotiationneeded = function( other )\r\n        {\r\n            // Generate offer.\r\n            call.connection.createOffer().then(function( sdp )\r\n            {\r\n                // Set caller local description.\r\n                call.connection.setLocalDescription(sdp);\r\n\r\n                let message =\r\n                {\r\n                    id: \"offer\",\r\n                    callId: event.callId,\r\n                    callerId: event.callerId,\r\n                    calleeId: event.calleeId,\r\n                    offer: JSON.stringify(sdp)\r\n                };\r\n                sendMessage(message);\r\n            });\r\n        };\r\n\r\n        // Add the tracks. This action triggers the ICE negotiation process.\r\n        let tracks = _settings.defaultStream.getTracks();\r\n        tracks.forEach(track => call.connection.addTrack(track));\r\n    };\r\n\r\n    /**\r\n     * Call canceled event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onCallCanceled = function( event )\r\n    {\r\n        closeCall(event.callId);\r\n    };\r\n\r\n    /**\r\n     * Remote offer event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onRemoteOffer = function( event )\r\n    {\r\n        // Create the peer connection.\r\n        let peerConnection = new RTCPeerConnection(_rtcConfiguration);\r\n        let call = _calls[event.callId];\r\n        call.connection = peerConnection;\r\n\r\n        // Handle the peer connection lifecycle.\r\n        call.connection.oniceconnectionstatechange = function( other )\r\n        {\r\n            onIceConnectionStateChange(call);\r\n        }\r\n\r\n        // Set callee remote description.\r\n        call.connection.setRemoteDescription(JSON.parse(event.offer));\r\n\r\n        // Gather the pending candidates.\r\n        call.gatherPendingCandidates();\r\n\r\n        // Generate candidates.\r\n        call.connection.onicecandidate = function( other )\r\n        {\r\n            if( !other.candidate || other.candidate === \"\" ) // Empty if the RTCIceCandidate is an \"end of candidates\" indicator.\r\n            {\r\n                return;\r\n            }\r\n\r\n            let message =\r\n            {\r\n                id: \"candidate\",\r\n                callId: event.callId,\r\n                callerId: event.callerId,\r\n                calleeId: event.calleeId,\r\n                candidate: JSON.stringify(other.candidate)\r\n            };\r\n            sendMessage(message);\r\n        };\r\n\r\n        // Add the tracks.\r\n        let tracks = _settings.defaultStream.getTracks();\r\n        tracks.forEach(track => call.connection.addTrack(track));\r\n\r\n        // Generate answer.\r\n        window.setTimeout(function()\r\n        {\r\n            call.connection.createAnswer().then(function( sdp )\r\n            {\r\n                // Set callee local description.\r\n                call.connection.setLocalDescription(sdp);\r\n\r\n                let message =\r\n                {\r\n                    id: \"answer\",\r\n                    callId: event.callId,\r\n                    callerId: event.callerId,\r\n                    calleeId: event.calleeId,\r\n                    answer: JSON.stringify(sdp)\r\n                };\r\n                sendMessage(message);\r\n            });\r\n        }, 500);\r\n    };\r\n\r\n    /**\r\n     * Remote answer event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onRemoteAnswer = function( event )\r\n    {\r\n        if( event.callId in _calls )\r\n        {\r\n            let answer = JSON.parse(event.answer);\r\n\r\n            // Set caller remote description.\r\n            _calls[event.callId].connection.setRemoteDescription(answer);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Remote candidate event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onRemoteCandidate = function( event )\r\n    {\r\n        let candidate = JSON.parse(event.candidate);\r\n        if( !candidate || !candidate.candidate || candidate.candidate === \"\" ) // Empty if the RTCIceCandidate is an \"end of candidates\" indicator.\r\n        {\r\n            return;\r\n        }\r\n\r\n        if( event.callId in _calls )\r\n        {\r\n            let call = _calls[event.callId];\r\n            call.addCandidate(candidate);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * User hangup event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onUserHangup = function( event )\r\n    {\r\n        closeCall(event.callId);\r\n    };\r\n\r\n    /**\r\n     * Handle the ICE connection state change event.\r\n     * @param {RTCCall} call - The call.\r\n     */\r\n    let onIceConnectionStateChange = async function( call )\r\n    {\r\n        let state = call.getState();\r\n        console?.log(\"%c\" + \"Connection State\" + \"%o%o\", settings.debugStyle, call.callId, state);\r\n\r\n        switch( state )\r\n        {\r\n            case \"failed\":\r\n            case \"disconnected\":\r\n            case \"closed\":\r\n            {\r\n                hangup(call.callId);\r\n                break;\r\n            }\r\n            case \"new\":\r\n            case \"checking\":\r\n            case \"completed\":\r\n            {\r\n                break;\r\n            }\r\n            case \"connected\":\r\n            {\r\n                let stream = call.getRemoteStream();\r\n                console?.log(\"%c\" + \"call_opened\" + \"%o%o\", settings.debugStyle, call.callId, stream);\r\n                emit(\"call_opened\", { call: call, stream: stream });\r\n\r\n                break;\r\n            }\r\n            default:\r\n            {\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Validates the specified ID following a regular expression.\r\n     * @param {String} id - The ID to validate.\r\n     * @return Whether or not the ID is valid.\r\n     */\r\n    let validateId = function( id )\r\n    {\r\n        if( !id || id === \"\" )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let regex = new RegExp(\"^([a-zA-Z])(([a-zA-Z0-9]+)([.\\-_]?))*([a-zA-Z0-9])$\");\r\n        return regex.test(id);\r\n    };\r\n\r\n    /**\r\n     * Handlers used to listen messages from the server.\r\n     *      function - The message is valid, emitted and managed.\r\n     *      true - The message is valid, emitted and not managed.\r\n     *      false - The message is valid, not emitted and not managed.\r\n     *      undefined - The message is not valid.\r\n     */\r\n    const HANDLERS =\r\n    {\r\n        \"pong\":                     false,\r\n        \"register_response\":        onRegisterResponse,\r\n        \"unregister_response\":      onUnregisterResponse,\r\n        \"call_response\":            onCallResponse,\r\n        \"incoming_call\":            onIncomingCall,\r\n        \"accept_call_response\":     false,\r\n        \"cancel_call_response\":     false,\r\n        \"call_accepted\":            onCallAccepted,\r\n        \"call_canceled\":            onCallCanceled,\r\n        \"offer_response\":           false,\r\n        \"remote_offer\":             onRemoteOffer,\r\n        \"answer_response\":          false,\r\n        \"remote_answer\":            onRemoteAnswer,\r\n        \"candidate_response\":       false,\r\n        \"remote_candidate\":         onRemoteCandidate,\r\n        \"hangup_response\":          true,\r\n        \"user_hangup\":              onUserHangup\r\n    };\r\n\r\n//#endregion\r\n\r\n//#region PUBLIC\r\n\r\n    return {\r\n        on,\r\n        off,\r\n        getCall,\r\n        getCalls,\r\n        connect,\r\n        disconnect,\r\n        register,\r\n        unregister,\r\n        call,\r\n        acceptCall,\r\n        cancelCall,\r\n        hangup\r\n    };\r\n\r\n//#endregion\r\n}\r\n\r\nexport function RTCCall( callId, callerId, calleeId )\r\n{\r\n//#region PRIVATE\r\n\r\n    let _callId = callId;\r\n    let _callerId = callerId;\r\n    let _calleeId = calleeId;\r\n\r\n    let _connection = null;\r\n    let _candidates = [];\r\n\r\n    /**\r\n     * Get the call state.\r\n     * @return {String} The call state.\r\n     */\r\n    let getState = function()\r\n    {\r\n        return (_connection) ? _connection.iceConnectionState : \"closed\";\r\n    }\r\n\r\n    /**\r\n     * Get the call stats.\r\n     * @return {Object} The call stats.\r\n     */\r\n    let getStats = async function()\r\n    {\r\n        if( !_connection )\r\n        {\r\n            return;\r\n        }\r\n\r\n        return await _connection.getStats(null).then(function( stats )\r\n        {\r\n            let callStats = { callId: _callId, callerId: _callerId, calleeId: _calleeId };\r\n\r\n            // Get the stats of the succeeded candidate pair.\r\n            let candidatePair = null;\r\n            stats.forEach(report =>\r\n            {\r\n                if( report.type === \"candidate-pair\" && (report.selected === true || report.state === \"succeeded\") )\r\n                {\r\n                    candidatePair = report;\r\n                }\r\n            });\r\n\r\n            // Get the stats of the local and remote candidates.\r\n            if( candidatePair )\r\n            {\r\n                stats.forEach(report =>\r\n                {\r\n                    if( report.id === candidatePair.localCandidateId )\r\n                    {\r\n                        callStats.localType = report.candidateType;\r\n                        callStats.localAddress = report.address ?? report.ip;\r\n                        callStats.localPort = report.port;\r\n                        callStats.localProtocol = report.protocol;\r\n                    }\r\n                    if( report.id === candidatePair.remoteCandidateId )\r\n                    {\r\n                        callStats.remoteType = report.candidateType;\r\n                        callStats.remoteAddress = report.address ?? report.ip;\r\n                        callStats.remotePort = report.port;\r\n                        callStats.remoteProtocol = report.protocol;\r\n                    }\r\n                });\r\n            }\r\n\r\n            return Promise.resolve(callStats);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Add a candidate or save it for gathering.\r\n     * @param {Object} candidate \r\n     */\r\n    let addCandidate = function( candidate )\r\n    {\r\n        if( !_connection )\r\n        {\r\n            _candidates.push(candidate);\r\n        }\r\n        else\r\n        {\r\n            _connection.addIceCandidate(candidate);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Gather the pending candidates.\r\n     */\r\n    let gatherPendingCandidates = function()\r\n    {\r\n        if( _candidates.length > 0 )\r\n        {\r\n            _candidates.forEach(candidate => _connection.addIceCandidate(candidate));\r\n            _candidates = [];\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the remote audio track specified by index.\r\n     * @param {Number} index\r\n     * @return {MediaStreamTrack} The audio track.\r\n     */\r\n    let getRemoteAudioTrack = function ( index = 0 )\r\n    {\r\n        if( !_connection )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let receivers = _connection.getReceivers();\r\n        if( !receivers )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let tracks = [];\r\n        for( let i = 0; i < receivers.length; i++ )\r\n        {\r\n            let receiver = receivers[i];\r\n            if( receiver.track.kind === \"audio\" )\r\n            {\r\n                tracks.push(receiver.track);\r\n            }\r\n        }\r\n\r\n        if( index >= 0 && index < tracks.length )\r\n        {\r\n            return tracks[index];\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * Get the remote video track specified by index.\r\n     * @param {Number} index\r\n     * @return {MediaStreamTrack} The video track.\r\n     */\r\n    let getRemoteVideoTrack = function ( index = 0 )\r\n    {\r\n        if( !_connection )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let receivers = _connection.getReceivers();\r\n        if( !receivers )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let tracks = [];\r\n        for( let i = 0; i < receivers.length; i++ )\r\n        {\r\n            let receiver = receivers[i];\r\n            if( receiver.track.kind === \"video\" )\r\n            {\r\n                tracks.push(receiver.track);\r\n            }\r\n        }\r\n\r\n        if( index >= 0 && index < tracks.length )\r\n        {\r\n            return tracks[index];\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    /**\r\n     * Get the remote stream of the peer connection composed by all the audio and video tracks.\r\n     * @return {MediaStream} The remote stream.\r\n     */\r\n    let getRemoteStream = function()\r\n    {\r\n        if( !_connection )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let receivers = _connection.getReceivers();\r\n        if( !receivers )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let tracks = [];\r\n        for( let i = 0; i < receivers.length; i++ )\r\n        {\r\n            let receiver = receivers[i];\r\n            if( receiver.track )\r\n            {\r\n                tracks.push(receiver.track);\r\n            }\r\n        }\r\n\r\n        if( tracks.length === 0 )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let stream = new MediaStream();\r\n        for( let i = 0; i < tracks.length; i++ )\r\n        {\r\n            let track = tracks[i];\r\n            stream.addTrack(track);\r\n        }\r\n\r\n        return stream;\r\n    };\r\n\r\n    /**\r\n     * Replace the local audio track specified by index.\r\n     * @param {MediaStreamTrack} track - The audio track.\r\n     * @param {Number} index\r\n     * @return Whether the track has been replaced.\r\n     */\r\n    let replaceLocalAudioTrack = function( track, index = 0 )\r\n    {\r\n        if( !_connection || !track )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let audioSenders = [];\r\n        let senders = _connection.getSenders();\r\n        for( let i = 0; i < senders.length; i++ )\r\n        {\r\n            let sender = senders[i];\r\n            if( sender.track && sender.track.kind === \"audio\" )\r\n            {\r\n                audioSenders.push(sender);\r\n            }\r\n        }\r\n\r\n        if( index >= 0 && index < audioSenders.length )\r\n        {\r\n            audioSenders[index].replaceTrack(track);\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Replace the local video track specified by index.\r\n     * @param {MediaStreamTrack} track - The video track.\r\n     * @param {Number} index\r\n     * @returns Whether the track has been replaced.\r\n     */\r\n    let replaceLocalVideoTrack = function( track, index = 0 )\r\n    {\r\n        if( !_connection || !track )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let videoSenders = [];\r\n        let senders = _connection.getSenders();\r\n        for( let i = 0; i < senders.length; i++ )\r\n        {\r\n            let sender = senders[i];\r\n            if( sender.track && sender.track.kind === \"video\" )\r\n            {\r\n                videoSenders.push(sender);\r\n            }\r\n        }\r\n\r\n        if( index >= 0 && index < videoSenders.length )\r\n        {\r\n            videoSenders[index].replaceTrack(track);\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n//#endregion\r\n\r\n//#region PUBLIC\r\n\r\n    return {\r\n        get callId() { return _callId; },\r\n        get callerId() { return _callerId; },\r\n        get calleeId() { return _calleeId; },\r\n        get connection() { return _connection; },\r\n        set connection( value ) { _connection = value; },\r\n        getState,\r\n        getStats,\r\n        addCandidate,\r\n        gatherPendingCandidates,\r\n        getRemoteAudioTrack,\r\n        getRemoteVideoTrack,\r\n        getRemoteStream,\r\n        replaceLocalAudioTrack,\r\n        replaceLocalVideoTrack\r\n    };\r\n\r\n//#endregion\r\n}","// eslint-disable\r\n\r\n//import AdapterJS from 'adapterjs';\r\nimport { RTCClient }    from \"./rtcClient.js\";      // eslint-disable-line\r\nimport { LobbyClient }  from './lobbyClient.js';      // eslint-disable-line\r\nimport { MediaAdapter } from \"./mediaAdapter.js\";   // eslint-disable-line\r\nimport { DummyStream }  from \"./dummyStream.js\";\r\n\r\nlet appClient    = window.appClient    = new LobbyClient(),\r\n    mediaAdapter = window.mediaAdapter = new MediaAdapter(),\r\n    dummyStream  = window.dummyStream  = new DummyStream(),\r\n    rtcClient    = window.rtcClient    = new RTCClient({ debug: true, defaultStream: dummyStream.getStream() });\r\n\r\n    appClient.DEBUG = false;\r\n    rtcClient.DEBUG = false;\r\n    mediaAdapter.DEBUG = false;\r\n\r\nexport {\r\n   rtcClient, \r\n   appClient,\r\n   mediaAdapter,\r\n   dummyStream\r\n}","export function LobbyClient( settings )\r\n{\r\n//#region PRIVATE\r\n\r\n    let _defaultSettings =\r\n    {\r\n        // Debug messages to console?\r\n        debug: false,\r\n\r\n        // Style used to debug messages.\r\n        debugStyle: \"background: hsla(0, 0%, 13%, 1); color: hsla(180, 89%, 45%, 1)\",\r\n\r\n        // Period to send ping messages in ms.\r\n        pingPeriod: 5 * 1000\r\n    };\r\n\r\n    settings = (typeof settings !== \"object\") ? { } : settings;\r\n    settings = Object.assign(_defaultSettings, settings);\r\n\r\n    let console = (settings.debug) ? window.console : null;\r\n\r\n    let _events = { };\r\n    let _token = null;\r\n    let _socket = null;\r\n    let _keepAliveTimeout = null;\r\n\r\n    let _userId = null;\r\n    let _roomId = null;\r\n    let _channels = { };\r\n\r\n    /**\r\n     * Add a function that will be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The function to add.\r\n     */\r\n    let on = function( event, listener )\r\n    {\r\n        if( typeof _events[event] !== \"object\" )\r\n        {\r\n            _events[event] = [];\r\n        }\r\n\r\n        _events[event].push(listener);\r\n    };\r\n\r\n    /**\r\n     * Remove the function previously added to be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The previously added function.\r\n     */\r\n    let off = function( event, listener )\r\n    {   \r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let index = _events[event].indexOf(listener);\r\n            if( index > -1 )\r\n            {\r\n                _events[event].splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Emit the specified event.\r\n     * @param {String} event - The event name.\r\n     */\r\n    let emit = function( event )\r\n    {\r\n        let args = [].slice.call(arguments, 1);\r\n\r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let listeners = _events[event].slice();\r\n            for( let i = 0; i < listeners.length; i++ )\r\n            {\r\n                listeners[i].apply(this, args);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Connect to the server.\r\n     * @param {String} url - The URL of the server.\r\n     */\r\n    let connect = function( url )\r\n    {\r\n        _socket = new WebSocket(url);\r\n\r\n        _socket.onopen = onOpen;\r\n        _socket.onmessage = onMessage;\r\n        _socket.onclose = onClose;\r\n    };\r\n\r\n    /**\r\n     * Event handler called when the connection is opened.\r\n     * @param {EventListener} event - The dispatched event.\r\n     */\r\n    let onOpen = function( event )\r\n    {\r\n        // Start the keep alive routine.\r\n        keepAlive();\r\n\r\n        console?.log(\"%cclient_connected%o\", settings.debugStyle, _socket.url);\r\n\r\n        emit(\"client_connected\", { url: _socket.url });\r\n    };\r\n\r\n    /**\r\n     * Event handler called when a message is received from the server.\r\n     * @param {EventListener} msg - The message received.\r\n     */\r\n    let onMessage = function( msg )\r\n    {\r\n        let message = JSON.parse(msg.data);\r\n\r\n        // Check the message.\r\n        if( message.id in HANDLERS )\r\n        {\r\n            if( HANDLERS[message.id] === false )\r\n            {\r\n                return;\r\n            }\r\n\r\n            console?.log(\"%c%s%o\", settings.debugStyle, message.id, msg.data);\r\n\r\n            if( HANDLERS[message.id] instanceof Function )\r\n            {\r\n                HANDLERS[message.id](message);\r\n            }\r\n\r\n            emit(message.id, message);\r\n        }\r\n        else\r\n        {\r\n            console?.log(\"%cunknown_message%o\", settings.debugStyle, msg.data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Send a message to the server.\r\n     * @param {Object} message - The message to send.\r\n     */\r\n    let sendMessage = function( message )\r\n    {\r\n        let msg = JSON.stringify(message);\r\n\r\n        // Log all messages except pings.\r\n        if( message.id !== \"ping\" )\r\n        {\r\n            console?.log(\" %c%s%o\", settings.debugStyle, message.id, msg);\r\n        }\r\n\r\n        _socket.send(msg);\r\n    };\r\n\r\n    /**\r\n     * Event handler called when the connection is closed.\r\n     * @param {EventListener} event - The dispatched event.\r\n     */\r\n    let onClose = function( event )\r\n    {\r\n        // Stop the keep alive routine.\r\n        window.clearTimeout(_keepAliveTimeout);\r\n\r\n        console?.log(\"%cclient_disconnected%o\", settings.debugStyle, _socket.url);\r\n\r\n        emit(\"client_disconnected\", { url: _socket.url });\r\n    };\r\n \r\n    /**\r\n     * Disconnect from the server.\r\n     */\r\n    let disconnect = function()\r\n    {\r\n        _socket?.close();\r\n    };\r\n\r\n    /**\r\n     * Start a keep alive routine.\r\n     */\r\n    let keepAlive = function()\r\n    {\r\n        if( !_socket )\r\n        {\r\n            console?.error(\"Websocket is null\");\r\n            return;\r\n        }\r\n\r\n        // Check whether the connection is open and ready to communicate.\r\n        if( _socket.readyState !== 1 )\r\n        {\r\n            console?.error(\"Connection not open, ready state \" + _socket.readyState);\r\n            return;\r\n        }\r\n\r\n        ping();\r\n\r\n        _keepAliveTimeout = window.setTimeout(keepAlive, settings.pingPeriod);\r\n    };\r\n\r\n    /**\r\n     * Send a ping to the server.\r\n     */\r\n    let ping = function()\r\n    {\r\n        let message = { id: \"ping\" };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Login to the server.\r\n     * @param {String} token - The authentication token.\r\n     */\r\n    let login = function( token )\r\n    {\r\n        _token = token;\r\n\r\n        let message = { id: \"login\", token: _token };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Logout from the server.\r\n     */\r\n    let logout = function()\r\n    {\r\n        let message = { id: \"logout\", token: _token };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Get the current room information.\r\n     */\r\n    let getRoom = function()\r\n    {\r\n        let message = { id: \"get_room\", token: _token };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Get the list of room informations.\r\n     */\r\n    let getRooms = function()\r\n    {\r\n        let message = { id: \"get_rooms\", token: _token };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Create a room.\r\n     * @param {String} roomId - The room ID.\r\n     */\r\n    let createRoom = function( roomId )\r\n    {\r\n        if( !validateId(roomId) )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let message = { id: \"create_room\", token: _token, roomId: roomId };\r\n        sendMessage(message);\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Join a room.\r\n     * @param {String} roomId - The room ID.\r\n     */\r\n    let joinRoom = function( roomId )\r\n    {\r\n        let message = { id: \"join_room\", token: _token, roomId: roomId };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Leave the room.\r\n     */\r\n    let leaveRoom = function()\r\n    {\r\n        let message = { id: \"leave_room\", token: _token };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Enable a user to the channel.\r\n     * @param {String} channelId - The channel ID.\r\n     */\r\n    let enableChannel = function( userId, channelId )\r\n    {\r\n        let message = { id: \"enable_channel\", token: _token, userId: userId, channelId: channelId };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Disable a user from the channel.\r\n     * @param {String} channelId - The channel ID.\r\n     */\r\n    let disableChannel = function( userId, channelId )\r\n    {\r\n        let message = { id: \"disable_channel\", token: _token, userId: userId, channelId: channelId };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Join a channel.\r\n     * @param {String} channelId - The channel ID.\r\n     */\r\n    let joinChannel = function( channelId )\r\n    {\r\n        let message = { id: \"join_channel\", token: _token, channelId: channelId };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Leave a channel.\r\n     * @param {String} channelId - The channel ID.\r\n     */\r\n    let leaveChannel = function( channelId )\r\n    {\r\n        let message = { id: \"leave_channel\", token: _token, channelId: channelId };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Forward a message to other user.\r\n     * @param {String} userId - The user ID.\r\n     * @param {Object} msg - The message to forward.\r\n     */\r\n    let forwardMessage = function( userId, msg )\r\n    {\r\n        if( _userId === userId )\r\n        {\r\n            return;\r\n        }\r\n\r\n        let message = { id: \"forward_message\", token: _token, userId: userId, msg: msg };\r\n        sendMessage(message);\r\n    };\r\n\r\n    /**\r\n     * Returns whether or not the client is disconnected.\r\n     * @returns Whether or not the client is disconnected.\r\n     */\r\n    let isDisconnected = function()\r\n    {\r\n        return !_socket || _socket.readyState === \"3\"; // Closed.\r\n    };\r\n\r\n    /**\r\n     * Returns whether or not the user is logged in this client.\r\n     * @param {String} userId - The user ID.\r\n     * @return Whether or not the user is logged in this client.\r\n     */\r\n    let isLogged = function( userId )\r\n    {\r\n        if( _userId )\r\n        {\r\n            return _userId === userId;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Returns whether or not the user is joined to the channel.\r\n     * @param {String} channelId - The channel ID.\r\n     * @return Whether or not the user is joined to the channel.\r\n     */\r\n    let isInChannel = function( channelId )\r\n    {\r\n        return channelId in _channels;\r\n    };\r\n\r\n    /**\r\n     * Validates the specified ID following a regular expression.\r\n     * @param {String} str - The ID to validate.\r\n     * @return Whether or not the ID is valid.\r\n     */\r\n    let validateId = function( id )\r\n    {\r\n        if( !id || id === \"\" )\r\n        {\r\n            return false;\r\n        }\r\n\r\n        let regex = new RegExp(\"^([a-zA-Z])(([a-zA-Z0-9]+)([.\\-_]?))*([a-zA-Z0-9])$\");\r\n        return regex.test(id);\r\n    };\r\n\r\n    /**\r\n     * Login response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onLoginResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _userId = event.userId;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Logout response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onLogoutResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _token = null;\r\n            _userId = null;\r\n            _roomId = null;\r\n            _channels = { };\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Create room response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onCreateRoomResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _roomId = event.roomId;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Join room response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onJoinRoomResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _roomId = event.roomId;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Leave room response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onLeaveRoomResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _roomId = null;\r\n            _channels = { };\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Channel disabled event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onChannelDisabled = function( event )\r\n    {\r\n        if( event.userId !== _userId )\r\n        {\r\n            return;\r\n        }\r\n\r\n        if( event.channelId in _channels )\r\n        {\r\n            delete _channels[event.channelId];\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Join channel response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onJoinChannelResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            _channels[event.channelId] = true;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Leave channel response event handler.\r\n     * @param {Object} event - The event object.\r\n     */\r\n    let onLeaveChannelResponse = function( event )\r\n    {\r\n        if( event.status === \"ok\" )\r\n        {\r\n            delete _channels[event.channelId];\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Handlers used to listen messages from the server.\r\n     *      function - The message is valid, emitted and handled.\r\n     *      true - The message is valid, emitted and not handled.\r\n     *      false - The message is valid, not emitted and not handled.\r\n     *      undefined - The message is not valid.\r\n     */\r\n    const HANDLERS =\r\n    {\r\n        \"pong\":                         false,\r\n        \"login_response\":               onLoginResponse,\r\n        \"logout_response\":              onLogoutResponse,\r\n        \"get_room_response\":            true,\r\n        \"get_rooms_response\":           true,\r\n        \"create_room_response\":         onCreateRoomResponse,\r\n        \"room_created\":                 true,\r\n        \"join_room_response\":           onJoinRoomResponse,\r\n        \"guest_joined_room\":            true,\r\n        \"user_joined_room\":             true,\r\n        \"leave_room_response\":          onLeaveRoomResponse,\r\n        \"master_left_room\":             true,\r\n        \"guest_left_room\":              true,\r\n        \"user_left_room\":               true,\r\n        \"room_deleted\":                 true,\r\n        \"enable_channel_response\":      true,\r\n        \"channel_enabled\":              true,\r\n        \"disable_channel_response\":     true,\r\n        \"channel_disabled\":             onChannelDisabled,\r\n        \"join_channel_response\":        onJoinChannelResponse,\r\n        \"user_joined_channel\":          true,\r\n        \"leave_channel_response\":       onLeaveChannelResponse,\r\n        \"user_left_channel\":            true,\r\n        \"forward_message_response\":     true,\r\n        \"remote_message\":               true\r\n    };\r\n\r\n//#endregion\r\n\r\n//#region PUBLIC\r\n\r\n    return {\r\n        on,\r\n        off,\r\n        connect,\r\n        disconnect,\r\n        login,\r\n        logout,\r\n        getRoom,\r\n        getRooms,\r\n        createRoom,\r\n        joinRoom,\r\n        leaveRoom,\r\n        enableChannel,\r\n        disableChannel,\r\n        joinChannel,\r\n        leaveChannel,\r\n        forwardMessage,\r\n        isDisconnected,\r\n        isLogged,\r\n        isInChannel\r\n    };\r\n\r\n//#endregion\r\n}\r\n","export function MediaAdapter( settings )\r\n{\r\n//#region PRIVATE\r\n\r\n    let _defaultSettings =\r\n    {\r\n        // Debug messages to console?\r\n        debug: false,\r\n\r\n        // Style used to debug messages.\r\n        debugStyle: \"background: hsla(0, 0%, 13%, 1); color: hsla(13, 89%, 45%, 1)\",\r\n    };\r\n\r\n    settings = (typeof settings !== \"object\") ? { } : settings;\r\n    settings = Object.assign(_defaultSettings, settings);\r\n\r\n    let console = (settings.debug) ? window.console : null;\r\n\r\n    let _events = { };\r\n    let _blackCanvas = null;\r\n    let _audioStream = null;\r\n    let _videoStream = null;\r\n    let _mediaStream = null;\r\n\r\n    let _audioDevices = { }; // _audioDevices[label] = deviceId\r\n    let _videoDevices = { }; // _videoDevices[label] = deviceId\r\n\r\n    let _resolutions =\r\n    {\r\n        \"Undefined\":    { width: undefined,\theight: undefined },\r\n        \"320x240\":      { width: 320,\theight: 240 },\t// QVGA 4:3\r\n        \"640x360\":      { width: 640,\theight: 360 },\t// nHD 16:9\r\n        \"640x480\":      { width: 640,\theight: 480 },\t// VGA 4:3\r\n        \"1280x720\":     { width: 1280,\theight: 720 },\t// HD 16:9\r\n        \"1920x1080\":    { width: 1920,\theight: 1080 },\t// FullHD 16:9\r\n        \"3840x2160\":    { width: 3840,\theight: 2160 },\t// 4k 16:9\r\n        \"7680x4320\":    { width: 7680,\theight: 4320 }\t// 8k 16:9\r\n    };\r\n\r\n    let _audioConstraints =\r\n    {\r\n        audio:\r\n        {\r\n            deviceId: { exact: undefined }\r\n        }\r\n    };\r\n\r\n    let _videoConstraints =\r\n    {\r\n        video:\r\n        {\r\n            deviceId: { exact: undefined },\r\n            width: { exact: undefined },\r\n            height: { exact: undefined },\r\n            frameRate: { ideal: 60 }\r\n        }\r\n    };\r\n\r\n    let _streamSettings =\r\n    {\r\n        audio: null, // label\r\n        video: null, // label\r\n        resolution: null, // _resolutions key\r\n    };\r\n\r\n    let _previousAudioConstraints = null;\r\n    let _previousVideoConstraints = null;\r\n\r\n    /**\r\n     * Add a function that will be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The function to add.\r\n     */\r\n    let on = function( event, listener )\r\n    {\r\n        if( typeof _events[event] !== \"object\" )\r\n        {\r\n            _events[event] = [];\r\n        }\r\n\r\n        _events[event].push(listener);\r\n    };\r\n\r\n    /**\r\n     * Remove the function previously added to be called whenever the specified event is emitted.\r\n     * @param {String} event - The event name.\r\n     * @param {Function} listener - The previously added function.\r\n     */\r\n    let off = function( event, listener )\r\n    {   \r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let index = _events[event].indexOf(listener);\r\n            if( index > -1 )\r\n            {\r\n                _events[event].splice(index, 1);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Emit the specified event.\r\n     * @param {String} event - The event name.\r\n     */\r\n    let emit = function( event )\r\n    {\r\n        let args = [].slice.call(arguments, 1);\r\n\r\n        if( typeof _events[event] === \"object\" )\r\n        {\r\n            let listeners = _events[event].slice();\r\n            for( let i = 0; i < listeners.length; i++ )\r\n            {\r\n                listeners[i].apply(this, args);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Start the media adapter.\r\n     */\r\n    let start = function()\r\n    {\r\n        if( !navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices )\r\n        {\r\n            console?.log(\"%c\" + \"Media Devices Error\" + \"%o\", settings.debugStyle, \"Media devices are not available\");\r\n            return false;\r\n        }\r\n\r\n        // Create a dummy stream.\r\n        _audioStream = getSilenceStream();\r\n        _videoStream = getBlackStream();\r\n        _mediaStream = mixStreams(_audioStream, _videoStream);\r\n\r\n        let initialize = async function()\r\n        {\r\n            const catchCallback = error => console?.trace(\"%c\" + \"Media Devices Error\" + \"%o\", settings.debugStyle, error);\r\n            \r\n            await window.navigator.mediaDevices.getUserMedia({ audio: true }).catch(catchCallback);\r\n            await window.navigator.mediaDevices.getUserMedia({ video: true }).catch(catchCallback);\r\n            await findDevices().catch(catchCallback);\r\n            await setDefaultDevices().catch(catchCallback);\r\n        };\r\n\r\n        initialize();\r\n\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Find the available media input and output devices.\r\n     */\r\n    let findDevices = async function()\r\n    {\r\n        return getDevices().then(gotDevices).catch(errorDevices);\r\n    };\r\n\r\n    /**\r\n     * Set the default devices.\r\n     */\r\n    let setDefaultDevices = async function()\r\n    {\r\n        // Try to get the media configuration from the local storage\r\n        // or use the default values.\r\n\r\n        let audio = window.localStorage.getItem(\"audio\") || \"None\";\r\n        if( !(audio in _audioDevices) )\r\n        {\r\n            audio = \"None\";\r\n            window.localStorage.removeItem(\"audio\");\r\n        }\r\n\r\n        let video = window.localStorage.getItem(\"video\") || \"None\";\r\n        if( !(video in _videoDevices) )\r\n        {\r\n            video = \"None\";\r\n            window.localStorage.removeItem(\"video\");\r\n        }\r\n\r\n        try\r\n        {\r\n            await setAudio(audio);\r\n            try\r\n            {\r\n                await setVideo(video);\r\n            }\r\n            catch( error )\r\n            {\r\n                setVideo(\"None\");\r\n            }\r\n        }\r\n        catch( error )\r\n        {\r\n            await setAudio(\"None\");\r\n            try\r\n            {\r\n                await setVideo(video);\r\n            }\r\n            catch( error )\r\n            {\r\n                setVideo(\"None\");\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Request a list of the available media input and output devices.\r\n     */\r\n    let getDevices = function()\r\n    {\r\n        return window.navigator.mediaDevices.enumerateDevices();\r\n    };\r\n\r\n    /**\r\n     * Success handler of the get devices function.\r\n     * @param {MediaDeviceInfo[]} deviceInfos - The collection of device infos.\r\n     */\r\n    let gotDevices = function( deviceInfos )\r\n    {\r\n        _audioDevices = { };\r\n        _videoDevices = { };\r\n\r\n        // Add inputs for silence and black streams.\r\n        _audioDevices[\"None\"] = \"\";\r\n        _videoDevices[\"None\"] = \"\";\r\n\r\n        let a = 0, v = 0;\r\n        for( let deviceInfo of deviceInfos )\r\n        {\r\n            if( deviceInfo.kind === \"audioinput\" )\r\n            {\r\n                let label = (deviceInfo.label === \"\" ) ? (\"Audio input \" + a) : deviceInfo.label;\r\n                _audioDevices[label] = deviceInfo.deviceId;\r\n                a++;\r\n            }\r\n\r\n            if( deviceInfo.kind === \"videoinput\" )\r\n            {\r\n                let label = (deviceInfo.label === \"\" ) ? (\"Video input \" + v) : deviceInfo.label;\r\n                _videoDevices[label] = deviceInfo.deviceId;\r\n                v++;\r\n            }\r\n        }\r\n\r\n        console?.log(\"%c\" + \"Device Infos\" + \"%o\", settings.debugStyle, JSON.stringify(deviceInfos));\r\n        console?.log(\"%c\" + \"got_devices\" + \"%o%o%o\", settings.debugStyle, JSON.stringify(_audioDevices), JSON.stringify(_videoDevices), JSON.stringify(_streamSettings));\r\n        console?.log(\"%c\" + \"got_resolutions\" + \"%o%o\", settings.debugStyle, JSON.stringify(_resolutions), JSON.stringify(_streamSettings));\r\n\r\n        emit(\"got_devices\", { audioDevices: _audioDevices, videoDevices: _videoDevices, settings: _streamSettings });\r\n        emit(\"got_resolutions\", { resolutions: _resolutions, settings: _streamSettings });\r\n    };\r\n\r\n    /**\r\n     * Error handler of the get devices function.\r\n     * @param {Error} error - The catched error.\r\n     */\r\n    let errorDevices = function( error )\r\n    {\r\n        let description = \"Device request not allowed in the browser context.\";\r\n\r\n        console?.log(\"%c\" + \"error_devices\" + \"%o%o\", settings.debugStyle, error, description);\r\n\r\n        emit(\"error_devices\", { error: error, description: description });\r\n    };\r\n\r\n    /**\r\n     * Set the audio device.\r\n     * @param {String} device - The audio device.\r\n     */\r\n    let setAudio = function( device )\r\n    {\r\n        // Check whether the device exists.\r\n        if( !(device in _audioDevices) )\r\n        {\r\n            return Promise.reject(new Error(\"Device \" + device + \" doesn't exist\"));\r\n        }\r\n\r\n        // Check whether the device is not already selected.\r\n        if( device === _streamSettings.audio )\r\n        {\r\n            return Promise.reject(new Error(\"Device \" + device + \" already selected\"));\r\n        }\r\n\r\n        if( device === \"None\" )\r\n        {\r\n            // Update settings.\r\n            _streamSettings.audio = device;\r\n\r\n            // Save settings.\r\n            window.localStorage.setItem(\"audio\", _streamSettings.audio);\r\n\r\n            // Get dummy stream.\r\n            _audioStream = getSilenceStream();\r\n            _mediaStream = mixStreams(_audioStream, _videoStream);\r\n\r\n            console?.log(\"%c\" + \"got_stream\" + \"%o%o\", settings.debugStyle, _mediaStream, JSON.stringify(_streamSettings));\r\n\r\n            emit(\"got_stream\", { stream: _mediaStream, settings: _streamSettings });\r\n\r\n            return Promise.resolve(_mediaStream);\r\n        }\r\n        else\r\n        {\r\n            // Save previous audio constraints.\r\n            _previousAudioConstraints = clone(_audioConstraints);\r\n\r\n            // Update audio device constraints.\r\n            let deviceId = _audioDevices[device];\r\n            _audioConstraints.audio.deviceId.exact = deviceId;\r\n\r\n            return getAudioStream();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Set the video device and resolution.\r\n     * @param {String} device - The video device.\r\n     * @param {String} resolution - The video resolution.\r\n     */\r\n    let setVideo = function( device, resolution = \"Undefined\" )\r\n    {\r\n        // Check whether the device exists.\r\n        if( !(device in _videoDevices) )\r\n        {\r\n            return Promise.reject(new Error(\"Device \" + device + \" doesn't exist\"));;\r\n        }\r\n\r\n        // Check whether the resolution exists.\r\n        if( !(resolution in _resolutions) )\r\n        {\r\n            return Promise.reject(new Error(\"Resolution \" + resolution + \" doesn't exist\"));\r\n        }\r\n\r\n        // Check whether the device and resolution is not already selected.\r\n        if( device === _streamSettings.video && resolution === _streamSettings.resolution )\r\n        {\r\n            return Promise.reject(new Error(\"Device \" + device + \" and resolution \" + resolution + \" already selected\"));\r\n        }\r\n\r\n        if( device === \"None\" )\r\n        {\r\n            // Update settings.\r\n            _streamSettings.video = device;\r\n            _streamSettings.resolution = resolution;\r\n\r\n            // Save settings.\r\n            window.localStorage.setItem(\"video\", _streamSettings.video);\r\n\r\n            // Get dummy stream.\r\n            let width = _resolutions[resolution].width;\r\n            let height = _resolutions[resolution].height;\r\n            _videoStream = getBlackStream(width, height);\r\n            _mediaStream = mixStreams(_audioStream, _videoStream);\r\n\r\n            console?.log(\"%c\" + \"got_stream\" + \"%o%o\", settings.debugStyle, _mediaStream, JSON.stringify(_streamSettings));\r\n\r\n            emit(\"got_stream\", { stream: _mediaStream, settings: _streamSettings });\r\n\r\n            return Promise.resolve(_mediaStream);\r\n        }\r\n        else\r\n        {\r\n            // Save previous video constraints.\r\n            _previousVideoConstraints = clone(_videoConstraints);\r\n\r\n            // Update video device constraints.\r\n            let deviceId = _videoDevices[device];\r\n            _videoConstraints.video.deviceId.exact = deviceId;\r\n\r\n            // Update video resolution constraints.\r\n            let width = _resolutions[resolution].width;\r\n            let height = _resolutions[resolution].height;\r\n            _videoConstraints.video.width.exact = width;\r\n            _videoConstraints.video.height.exact = height;\r\n\r\n            return getVideoStream();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Return a silence audio track.\r\n     * @return {MediaStreamTrack} The silence audio track.\r\n     */\r\n    let getSilenceTrack = function()\r\n    {\r\n        let audioContext = new AudioContext();\r\n\r\n        let gainNode = audioContext.createGain();\r\n        let oscillatorNode = audioContext.createOscillator();\r\n        oscillatorNode.connect(gainNode);\r\n        let destination = gainNode.connect(audioContext.createMediaStreamDestination());\r\n\r\n        gainNode.gain.setValueAtTime(0, audioContext.currentTime);\r\n        oscillatorNode.start();\r\n\r\n        let stream = destination.stream;\r\n        let audioTrack = stream.getAudioTracks()[0];\r\n\r\n        return audioTrack;\r\n    };\r\n\r\n    /**\r\n     * Return a black video track.\r\n     * @param {Number} width - The video track width.\r\n     * @param {Number} height - The video track height.\r\n     * @return {MediaStreamTrack} The black video track.\r\n     */\r\n    let getBlackTrack = function( width = 320, height = 240 )\r\n    {\r\n        if( !_blackCanvas )\r\n        {\r\n            _blackCanvas = window.document.createElement(\"canvas\");\r\n        }\r\n\r\n        _blackCanvas.width = width;\r\n        _blackCanvas.height = height;\r\n        let context = _blackCanvas.getContext(\"2d\");\r\n        context.fillRect(0, 0, width, height);\r\n\r\n        let stream = _blackCanvas.captureStream();\r\n        let videoTrack = stream.getVideoTracks()[0];\r\n\r\n        return videoTrack;\r\n    };\r\n\r\n    /**\r\n     * Return a silenced audio stream.\r\n     */\r\n    let getSilenceStream = function()\r\n    {\r\n        return new MediaStream([getSilenceTrack()]);\r\n    };\r\n\r\n    /**\r\n     * Return a black video stream.\r\n     * @param {Number} width - The video stream width.\r\n     * @param {Number} height - The video stream height.\r\n     */\r\n    let getBlackStream = function( width = 320, height = 240 )\r\n    {\r\n        return new MediaStream([getBlackTrack(width, height)]);\r\n    };\r\n\r\n    /**\r\n     * Request an audio stream.\r\n     */\r\n    let getAudioStream = function()\r\n    {\r\n        console?.log(\"%c\" + \"Get Audio Stream\" + \"%o\", settings.debugStyle, JSON.stringify(_audioConstraints));\r\n\r\n        _mediaStream = null;\r\n        stopStream(_audioStream);\r\n\r\n        return window.navigator.mediaDevices.getUserMedia(_audioConstraints).then(gotAudioStream).catch(function( error )\r\n        {\r\n            errorAudioStream(error);\r\n            throw error;\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Request a video stream.\r\n     */\r\n    let getVideoStream = function()\r\n    {\r\n        console?.log(\"%c\" + \"Get Video Stream\" + \"%o\", settings.debugStyle, JSON.stringify(_videoConstraints));\r\n\r\n        _mediaStream = null;\r\n        stopStream(_videoStream);\r\n\r\n        return window.navigator.mediaDevices.getUserMedia(_videoConstraints).then(gotVideoStream).catch(function( error )\r\n        {\r\n            errorVideoStream(error);\r\n            throw error;\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Success handler of the get audio stream function.\r\n     * @param {MediaStream} stream - The audio stream.\r\n     */\r\n    let gotAudioStream = async function( stream )\r\n    {\r\n        // Audio track.\r\n        let audioTrack = stream.getAudioTracks()[0];\r\n        let audioTrackSettings = audioTrack.getSettings();\r\n        console?.log(\"%c\" + \"Audio Track\" + \"%o%o\", settings.debugStyle, JSON.stringify(audioTrack.label), JSON.stringify(audioTrackSettings));\r\n\r\n        // Check whether the label is listed, enumerateDevices returns an empty label if the permission for accessing the mediadevice is not given.\r\n        if( !(audioTrack.label in _audioDevices) )\r\n        {\r\n            await findDevices();\r\n        }\r\n\r\n        // Update settings.\r\n        _streamSettings.audio = audioTrack.label;\r\n\r\n        // Save settings.\r\n        window.localStorage.setItem(\"audio\", _streamSettings.audio);\r\n\r\n        _audioStream = stream;\r\n        _mediaStream = mixStreams(_audioStream, _videoStream);\r\n\r\n        console?.log(\"%c\" + \"Audio Constraints\" + \"%o\", settings.debugStyle, JSON.stringify(_audioConstraints));\r\n        console?.log(\"%c\" + \"got_stream\" + \"%o%o\", settings.debugStyle, _mediaStream, JSON.stringify(_streamSettings));\r\n\r\n        emit(\"got_stream\", { stream: _mediaStream, settings: _streamSettings });\r\n    };\r\n\r\n    /**\r\n     * Success handler of the get video stream function.\r\n     * @param {MediaStream} stream - The video stream.\r\n     */\r\n    let gotVideoStream = async function( stream )\r\n    {\r\n        // Video track.\r\n        let videoTrack = stream.getVideoTracks()[0];\r\n        let videoTrackSettings = videoTrack.getSettings();\r\n        console?.log(\"%c\" + \"Video Track\" + \"%o%o\", settings.debugStyle, JSON.stringify(videoTrack.label), JSON.stringify(videoTrackSettings));\r\n\r\n        // Check whether the label is listed, enumerateDevices returns an empty label if the permission for accessing the mediadevice is not given.\r\n        if( !(videoTrack.label in _videoDevices) )\r\n        {\r\n            await findDevices();\r\n        }\r\n\r\n        // Check whether the resolution is already listed.\r\n        let width = videoTrackSettings.width;\r\n        let height = videoTrackSettings.height;\r\n        let resolution = width + \"x\" + height;\r\n        if( !_resolutions[resolution] )\r\n        {\r\n            // Add the resolution.\r\n            _resolutions[resolution] = { width: width, height: height };\r\n\r\n            // Sort resolutions.\r\n            _resolutions = Object.entries(_resolutions).sort((a, b) => (a[1].width || Number.NEGATIVE_INFINITY) > (b[1].width || Number.NEGATIVE_INFINITY)).reduce((r, [k, v]) => ({ ...r, [k]: v }), {});\r\n\r\n            emit(\"got_resolutions\", { resolutions: _resolutions, settings: _streamSettings });\r\n        }\r\n\r\n        // Update video constraints.\r\n        _videoConstraints.video.width.exact = width;\r\n        _videoConstraints.video.height.exact = height;\r\n\r\n        // Update settings.\r\n        _streamSettings.video = videoTrack.label;\r\n        _streamSettings.resolution = resolution;\r\n\r\n        // Save settings.\r\n        window.localStorage.setItem(\"video\", _streamSettings.video);\r\n\r\n        _videoStream = stream;\r\n        _mediaStream = mixStreams(_audioStream, _videoStream);\r\n\r\n        console?.log(\"%c\" + \"Video Constraints\" + \"%o\", settings.debugStyle, JSON.stringify(_videoConstraints));\r\n        console?.log(\"%c\" + \"got_stream\" + \"%o%o\", settings.debugStyle, _mediaStream, JSON.stringify(_streamSettings));\r\n\r\n        emit(\"got_stream\", { stream: _mediaStream, settings: _streamSettings });\r\n    };\r\n\r\n    /**\r\n     * Return a semantic error string from the specified error.\r\n     * @param {Error} error - The catched error.\r\n     */\r\n    let errorStream = function( error )\r\n    {\r\n        let description = \"\";\r\n        if( error.name === \"NotFoundError\" || error.name === \"DevicesNotFoundError\" )\r\n        {\r\n            description = \"Required track is missing.\";\r\n        }\r\n        else if( error.name === \"NotReadableError\" || error.name === \"TrackStartError\" )\r\n        {\r\n            description = \"Microphone or Webcam are already in use.\";\r\n        }\r\n        else if( error.name === \"OverconstrainedError\" || error.name === \"ConstraintNotSatisfiedError\" )\r\n        {\r\n            description = \"Constraints cannot be satisfied.\";\r\n        }\r\n        else if( error.name === \"NotAllowedError\" || error.name === \"PermissionDeniedError\" )\r\n        {\r\n            description = \"Permission denied in browser.\";\r\n        }\r\n        else if( error.name === \"TypeError\" || error.name === \"TypeError\" )\r\n        {\r\n            description = \"Empty constraints object.\";\r\n        }\r\n        else\r\n        {\r\n            description = \"Unknown error.\";\r\n        }\r\n\r\n        return description + \" \" + error.message;\r\n    };\r\n\r\n    /**\r\n     * Error handler of the get audio stream function.\r\n     * @param {Error} error - The catched error.\r\n     */\r\n    let errorAudioStream = function( error )\r\n    {\r\n        let description = errorStream(error);\r\n\r\n        console?.log(\"%c\" + \"Error Constraints\" + \"%o\", settings.debugStyle, JSON.stringify(_audioConstraints));\r\n        console?.log(\"%c\" + \"error_stream\" + \"%o%o%o\", settings.debugStyle, error.name, description, JSON.stringify(_streamSettings));\r\n\r\n        emit(\"error_stream\", { error: error.name, description: description, settings: _streamSettings });\r\n\r\n        if( _previousAudioConstraints )\r\n        {\r\n            _audioConstraints = clone(_previousAudioConstraints);\r\n            _previousAudioConstraints = null;\r\n            getAudioStream();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Error handler of the get video stream function.\r\n     * @param {Error} error - The catched error.\r\n     */\r\n    let errorVideoStream = function( error )\r\n    {\r\n        let description = errorStream(error);\r\n\r\n        console?.log(\"%c\" + \"Error Constraints\" + \"%o\", settings.debugStyle, JSON.stringify(_videoConstraints));\r\n        console?.log(\"%c\" + \"error_stream\" + \"%o%o%o\", settings.debugStyle, error.name, description, JSON.stringify(_streamSettings));\r\n\r\n        emit(\"error_stream\", { error: error.name, description: description, settings: _streamSettings });\r\n\r\n        if( _previousVideoConstraints )\r\n        {\r\n            _videoConstraints = clone(_previousVideoConstraints);\r\n            _previousVideoConstraints = null;\r\n            getVideoStream();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Mix two streams with 1 audio and 1 video tracks into one.\r\n     * @param {MediaStream} audioStream - The stream with the audio track.\r\n     * @param {MediaStream} videoStream - The stream with the video track.\r\n     * @return {MediaStream} The mixed stream.\r\n     */\r\n    let mixStreams = function( audioStream, videoStream )\r\n    {\r\n        if( !audioStream || !(audioStream instanceof MediaStream) )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        if( !videoStream || !(videoStream instanceof MediaStream) )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let audioTracks = audioStream.getAudioTracks();\r\n        if( !audioTracks || audioTracks.length === 0 )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let videoTracks = videoStream.getVideoTracks();\r\n        if( !videoTracks || videoTracks.length === 0 )\r\n        {\r\n            return null;\r\n        }\r\n\r\n        let stream = new MediaStream();\r\n        stream.addTrack(audioTracks[0]);\r\n        stream.addTrack(videoTracks[0]);\r\n\r\n        return stream;\r\n    };\r\n\r\n    /**\r\n     * Stop a stream, stopping its tracks.\r\n     * @param {MediaStream} stream - The stream to stop.\r\n     */\r\n    let stopStream = function( stream )\r\n    {\r\n        if( !stream || !(stream instanceof MediaStream) )\r\n        {\r\n            return;\r\n        }\r\n\r\n        stream.getTracks().forEach(track => track.stop());\r\n    };\r\n\r\n    /**\r\n     * Return a clone of the object.\r\n     * @param {Object} object - The object to clone.\r\n     * @return {Object} The clone of the object.\r\n     */\r\n    let clone = function( object )\r\n    {\r\n        return JSON.parse(JSON.stringify(object));\r\n    };\r\n\r\n//#endregion\r\n\r\n//#region PUBLIC\r\n\r\n    return {\r\n        on,\r\n        off,\r\n        start,\r\n        findDevices,\r\n        getDevices,\r\n        setAudio,\r\n        setVideo\r\n    };\r\n\r\n//#endregion\r\n}","export function DummyStream()\r\n{\r\n//#region PRIVATE\r\n\r\n    let _blackCanvas = null;\r\n    let _silenceStream = null;\r\n    let _blackStream = null;\r\n    let _silenceTrack = null\r\n    let _blackTrack = null;\r\n\r\n    /**\r\n     * Create a silence audio track.\r\n     */\r\n    let createSilenceTrack = function()\r\n    {\r\n        let audioContext = new AudioContext();\r\n\r\n        let gainNode = audioContext.createGain();\r\n        let oscillatorNode = audioContext.createOscillator();\r\n        oscillatorNode.connect(gainNode);\r\n        let destination = gainNode.connect(audioContext.createMediaStreamDestination());\r\n\r\n        _silenceStream = destination.stream;\r\n        _silenceTrack = _silenceStream.getAudioTracks()[0];\r\n    };\r\n\r\n    /**\r\n     * Create a black video track.\r\n     * @param {Number} width - The video width.\r\n     * @param {Number} height - The video height.\r\n     */\r\n    let createBlackTrack = function( width = 320, height = 240 )\r\n    {\r\n        if( !_blackCanvas )\r\n        {\r\n            _blackCanvas = window.document.createElement(\"canvas\");\r\n        }\r\n\r\n        _blackCanvas.width = width;\r\n        _blackCanvas.height = height;\r\n        let context = _blackCanvas.getContext(\"2d\");\r\n        context.fillRect(0, 0, width, height);\r\n\r\n        _blackStream = _blackCanvas.captureStream();\r\n        _blackTrack = _blackStream.getVideoTracks()[0];\r\n    };\r\n\r\n    createSilenceTrack();\r\n    createBlackTrack();\r\n    let _stream = new MediaStream([_silenceTrack, _blackTrack]);\r\n\r\n    /**\r\n     * Return the audio track.\r\n     * @returns {MediaStreamTrack} The audio track.\r\n     */\r\n    let getAudioTrack = function()\r\n    {\r\n        return _silenceTrack;\r\n    };\r\n\r\n    /**\r\n     * Return the video track.\r\n     * @returns {MediaStreamTrack} The video track.\r\n     */\r\n    let getVideoTrack = function()\r\n    {\r\n        return _blackTrack;\r\n    };\r\n\r\n    /**\r\n     * Return the stream.\r\n     * @returns {MediaStream} The stream.\r\n     */\r\n    let getStream = function()\r\n    {\r\n        return _stream;\r\n    };\r\n\r\n//#endregion\r\n\r\n//#region PUBLIC\r\n\r\n    return {\r\n        getAudioTrack,\r\n        getVideoTrack,\r\n        getStream\r\n    };\r\n\r\n//#endregion\r\n}","export function setCookie(cName, cValue, expDays) {\r\n    let date = new Date();\r\n    date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));\r\n    document.cookie = `${cName}=${cValue}; expires=${date.toUTCString()}; path=/`;//cName + \"=\" + cValue + \"; \" + expires + \"; path=/\";\r\n}\r\n\r\nexport function getCookie(cName) {\r\n    const name = cName + \"=\";\r\n    const cDecoded = decodeURIComponent(document.cookie); //to be careful\r\n    const cArr = cDecoded.split('; ');\r\n    let res;\r\n    cArr.forEach(val => {\r\n        if (val.indexOf(name) === 0) res = val.substring(name.length);\r\n    })\r\n    return res;\r\n}","export default \"data:image/png;base64,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\"","import React, { useState, useEffect, useReducer, useContext, lazy, Suspense } from 'react';\r\nimport { BrowserRouter as Router, Switch, Route, Redirect, Link, useHistory } from 'react-router-dom';\r\nimport { Image, Button, ProgressBar  } from 'react-bootstrap';\r\n\r\nimport { getCookie, setCookie } from 'extra/cookies';\r\nimport { rtcClient, appClient, mediaAdapter } from 'extra/bra';\r\n\r\nimport {ToastContext} from 'components/toasts';\r\nimport {StreamSettings} from 'components/streamSettings';\r\n\r\nimport \"./app.scss\";\r\nimport img3 from 'assets/img/wizard2.png';\r\n\r\n\r\nconst Room = lazy(() => import('views/room'));\r\nconst Login = lazy(() => import('views/login'));\r\nconst Lobby = lazy(() => import('views/lobby'));\r\nconst Wizzard = lazy(() => import('views/wizzard'));\r\nconst ResetPassword = lazy(() => import('views/reset-password'));\r\nconst Navbar = lazy(() => import('components/navbar'));\r\n\r\n\r\nlet timeoutId; \r\nexport default function App() {\r\n\r\n    const rtcUrl = \"wss://admire-dev-rtc.brainstorm3d.com/\";\r\n    const appUrl = \"wss://admire-dev-lobby.brainstorm3d.com/\";\r\n\r\n    const history = useHistory();\r\n    const Log = useContext(ToastContext);\r\n    const { videoRef, devices:[devices,setDevices], settings:[settings,setSettings], localStream:[localStream,setLocalStream] } = useContext(StreamSettings);\r\n    \r\n    const [login, setLogin]       = useState(null);\r\n    const [fetching, setFetching] = useState(false);\r\n    const [NavItems, setNavItems] = useState({});\r\n\r\n    const [ready, setReady] = useReducer((state, newState)=>{ \r\n        localStorage.setItem('admire-user-ready', newState);\r\n        sessionStorage.setItem('admire-user-ready', newState);\r\n        return newState; \r\n    }, null, \r\n    (initialValue)=>{\r\n        let state = JSON.parse(sessionStorage.getItem('admire-user-ready') ?? localStorage.getItem('admire-user-ready')) ?? initialValue;\r\n        localStorage.setItem('admire-user-ready', state);\r\n        sessionStorage.setItem('admire-user-ready', state); \r\n        return state;\r\n    });  \r\n\r\n    \r\n    useEffect(() => { //Acts like 'componentWillMount'\r\n            console.clear();    \r\n            //setFetching(true);\r\n            setNavItem( 'wizzard',<Link to='/wizzard'> <li> <Image src={img3} style={{filter:'invert(1)'}} width={24}/> Wizzard</li> </Link> );\r\n\r\n            appClient.on(\"logout_response\",      onLogOut);\r\n            appClient.on('client_connected',     onAppClientConnect);\r\n            appClient.on('client_disconnected',  onDisconnect);\r\n            //appClient.on(\"autologin_response\",   onAutoLoginResponse);\r\n            \r\n            rtcClient.on('client_connected',     onRtcClientConnect);\r\n            \r\n            appClient.connect(appUrl);\r\n            \r\n        return () => {//Acts like /componentWillUnmount'\r\n            setNavItem('wizzard', null);\r\n\r\n            appClient.off('client_connected',    onAppClientConnect);\r\n            appClient.off('client_disconnected', onDisconnect);\r\n            appClient.off(\"logout_response\",     onLogOut);\r\n            \r\n            rtcClient.off('client_connected',    onRtcClientConnect);\r\n\r\n            appClient.disconnect();\r\n            rtcClient.disconnect();\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [appUrl, rtcUrl]); //This are the direct dependencies, the useEffect applies an observer pattern, whenever the value changes, the useEffect is called again.\r\n\r\n    function onAppClientConnect(event) {\r\n        Log.info(`App client connected`);\r\n        rtcClient.connect(rtcUrl);\r\n    }\r\n\r\n    function onRtcClientConnect(event) {\r\n        Log.info(`Rtc client connected`);\r\n        //appClient.autologin();\r\n        mediaAdapter.start();\r\n    }\r\n\r\n    function onDisconnect() {\r\n        Log.warn(`App client disconnected`);\r\n    }\r\n\r\n    /*function onAutoLoginResponse(event){\r\n        let {status, description, userId, userType} = event;\r\n        //setFetching(false);\r\n\r\n        switch(status)\r\n        {\r\n            case 'ok': {\r\n                Log.success(`Autlogin for ${userId}`);\r\n                setLogin({id:userId, type:userType}); \r\n                rtcClient.register(userId);\r\n                break;\r\n            }\r\n            case 'error': Log.error(description);break;\r\n            default: Log.warn(description); break;\r\n        }\r\n    }*/\r\n\r\n    function doLogOut(){\r\n        setCookie('credentials',null, 0);\r\n        appClient.logout();\r\n    }\r\n\r\n    function onLogOut(){\r\n        Log.info(`Logout`);\r\n        setLogin(null);\r\n        rtcClient.unregister();\r\n    }\r\n\r\n    function setNavItem(id, item)\r\n    {  \r\n        if(item === null)\r\n            delete NavItems[id];\r\n        else\r\n            NavItems[id] = item;\r\n\r\n        setNavItems( Object.assign({},NavItems) );\r\n    }\r\n\r\n    \r\n    const renderLoader = () => (<>\r\n        <ProgressBar animated now={100} />\r\n    </>);\r\n\r\n    return (<>\r\n        {\r\n            document.fullscreenEnabled && \r\n            <Button onClick={()=>document.fullscreen?document.exitFullscreen():document.body.requestFullscreen()} variant=\"link\" style={{zIndex:10000, position:\"absolute\", top:10, right:10, border:\"none\", boxShadow:\"none\"}}> <i className={\"bi \" + document.fullscreen?\"bi-fullscreen-exit\":\"bi-fullscreen\"}></i> </Button>    \r\n        }\r\n      \r\n        <Suspense fallback={renderLoader()}>\r\n        <Router>\r\n            { !login && <Route exact path='/reset-password/:token'> <ResetPassword/> </Route> }\r\n            { !login && <Route><Login login={login} setLogin={setLogin}/></Route> }\r\n\r\n            { login && <div className=\"app wrapper\">\r\n                <Navbar user={login} doLogOut={doLogOut} items={Object.values(NavItems)}/>\r\n                <div id=\"content\">\r\n                <Switch>\r\n                        { !ready && <Wizzard user={login} ready={{ready, setReady}} setNavItem={setNavItem}/> }\r\n                        <Route exact path='/wizzard'> <Wizzard user={login} ready={{ready, setReady}} setNavItem={setNavItem}/> </Route>\r\n                        <Route exact path='/rooms/:roomId'> <Room user={login} setNavItem={setNavItem}/> </Route>\r\n                        <Route> <Lobby setLogin={setLogin} user={login} setNavItem={setNavItem} key={Math.floor((Math.random() * 10000))} /> </Route>\r\n                </Switch>\r\n                </div>\r\n            </div> }\r\n        </Router>\r\n        </Suspense>\r\n    </>);\r\n}","import React, { useEffect, useState } from 'react';\r\nimport Helmet from 'react-helmet';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport 'bootstrap/dist/js/bootstrap.bundle.min.js';\r\nimport 'bootstrap/scss/bootstrap.scss';\r\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\r\nimport \"style.scss\";\r\n\r\nimport toast, { Toaster } from 'react-hot-toast';\r\n\r\nimport ToastContext from 'components/toasts';\r\nimport StreamSettings from 'components/streamSettings';\r\n\r\nimport App from \"views/app\";\r\n\r\n\r\nfunction ContextContainer({ children }) {\r\n  useEffect(() => window.toast = toast, [])\r\n  const [state, setState] = useState(0);\r\n\r\n  return <>\r\n    <Helmet>\r\n      <link rel=\"preload\" as=\"stylesheet\" href=\"bootstrap-icons/font/bootstrap-icons.css\"/>\r\n    </Helmet>\r\n    <ToastContext>\r\n\r\n      <Toaster\r\n        position=\"top-right\"\r\n        reverseOrder={false}\r\n      />\r\n      <StreamSettings>\r\n        {children}\r\n      </StreamSettings>\r\n    </ToastContext>\r\n  </>\r\n}\r\n\r\nReactDOM.render(\r\n  <ContextContainer>\r\n    <App />\r\n  </ContextContainer>\r\n  , document.getElementById('root')\r\n);"],"sourceRoot":""}